
<!DOCTYPE html>
<html>
<head>
  <title>Polyline Viewer</title>
  <meta charset="utf-8" />
  <style>html, body, #map { height: 100%; margin:0; padding:0; }</style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@mapbox/polyline"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const routeEnc = params.get('route');
    const dxEnc = params.get('dx');

    const map = L.map('map').setView([0, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    function drawPolyline(encoded, color, label) {
      if (!encoded) return;
      try {
        const coords = polyline.decode(encoded);
        const latlngs = coords.map(([lat, lng]) => [lat, lng]);
        L.polyline(latlngs, { color, weight: 4 }).addTo(map).bindPopup(label);
        map.fitBounds(latlngs);
      } catch (e) {
        console.error(`Failed to decode ${label}:`, e);
      }
    }

    drawPolyline(routeEnc, 'blue', 'Route');
    drawPolyline(dxEnc, 'red', 'Dasher Path');
  </script>
</body>
</html>
